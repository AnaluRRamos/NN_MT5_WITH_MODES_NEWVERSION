

# Entity-Aware NMT for Biomedical Texts

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Python 3.8+](https://img.shields.io/badge/python-3.8%2B-blue.svg)]

A neural machine-translation system based on mT5 that incorporates biomedical named-entity information to improve translation fidelity on domain-specific terms.  

## Features

- Entity-aware encoder: highlights genes, chemicals, diseases, etc.
- You have two modes, mode 0 a fine tuned model, and mode 1 a entity aware for biomedical terms model.
- Dynamic loss weighting: penalizes mistakes on entities more heavily.  
- Includes scripts for BLEU, CHRF, METEOR, ROUGE evaluation.
- It also includes a Manual tailored for Human evaluation 

## Table of Contents

1. [Installation](#installation)  
2. [Usage](#usage)  
3. [Configuration](#configuration)  
4. [Evaluation](#evaluation)  
5. [Citation](#citation)  
6. [License](#license)  
7. [Contact](#contact)  

## Installation

1. Clone this repository:  
   ```bash
   git clone https://github.com/AnaluRRamos/NN_MT5_WITH_MODES_NEWVERSION/
   cd biomedical-nmt-entity-aware

- Preprocess
  
Firt step is to preprocess the data, in this case is tokenize and also create the labels for NE for biomedical terms, for that use the preprocess_data.py (src). Inside the preprocess you will see a code where we read the text and tokenize for mt5 and also create the entity embbeding that will be used for MODE 1 in the model.py. 

- Train

After the preprocess lets train the model! But first you need to check the config.py inside the src and make sure which MODE do you want to use, 0 or 1. MODE 1 uses the entity embedding information to change the loss according to the biomedical terms. The idea here is to make the model dont mistakes with those important words. You can also change other hyperparameters. 
Peferct! If you check all of that, you can train the model going to the cli file, inside there is the run_train.py. This is the file you need to use to train.

- Test

Now if you want to use the checkpoint generated by the train, just check the path and then you can run the run_test.py.

To change the mode, go to the config.py and change manually.
The data files are just to heavy therefore they will be shared: 
